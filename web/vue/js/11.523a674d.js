(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[11],{eb64:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("q-page",{attrs:{padding:""}},[e("backtester")],1)},r=[],n=function(){var t=this,e=t._self._c;return e("div",[e("h3",{staticClass:"text-h6 q-mb-md"},[t._v("Backtest")]),e("p",[t._v("debug javascript code here.")]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-12"},[e("config-builder",{on:{config:t.check}})],1)]),t.backtestable?e("div",{staticClass:"row justify-center q-mt-md"},[e("q-btn",{attrs:{color:"primary",loading:"fetching"===t.backtestState,disabled:"fetching"===t.backtestState},on:{click:function(e){return e.preventDefault(),t.run.apply(null,arguments)}}},[t._v("Backtest")])],1):t._e(),t.backtestable?e("div",{staticClass:"row justify-center q-mt-md"},["fetching"===t.backtestState?e("div",{staticClass:"text-center"},[e("h4",[t._v("Running backtest...")]),e("q-spinner-bars",{attrs:{color:"secondary",size:"48px"}})],1):t._e()]):t._e(),t.backtestResult&&"fetched"===t.backtestState?e("result",{attrs:{result:t.backtestResult}}):t._e()],1)},i=[],c=function(){var t=this,e=t._self._c;return e("div",[e("dataset-picker",{on:{dataset:t.updateDataset}}),e("strat-picker",{on:{stratConfig:t.updateStrat}}),e("paper-trader",{on:{settings:t.updatePaperTrader}})],1)},o=[],l=a("7ec2"),d=a.n(l),u=a("c973"),p=a.n(u),m=(a("cca6"),function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"text-h5 q-mb-md"},[t._v("Select a dataset "+t._s(t.selectedText))]),"idle"===t.datasetScanstate?e("div",{staticClass:"text-center"},[e("q-btn",{attrs:{color:"primary"},on:{click:function(e){return e.preventDefault(),t.scan.apply(null,arguments)}}},[t._v("Scan available data")])],1):t._e(),e("div",{staticClass:"text-center"},["scanning"===t.datasetScanstate?e("q-spinner-bars",{attrs:{color:"secondary",size:"48px"}}):t._e()],1),"scanned"===t.datasetScanstate?e("div",[t.datasets.length?e("q-table",{attrs:{title:"Local Datasets","row-key":"id",data:t.datasets,columns:t.tblColumns,dense:"",filter:t.dsFilter,selection:"single",selected:t.selectedRows,separator:"vertical"},on:{"update:selected":function(e){t.selectedRows=e}},scopedSlots:t._u([{key:"top-right",fn:function(a){return[e("q-input",{staticClass:"col-6",attrs:{debounce:"300","hide-underline":"",color:"secondary"},scopedSlots:t._u([{key:"append",fn:function(){return[e("q-icon",{attrs:{name:"search"}})]},proxy:!0}],null,!0),model:{value:t.dsFilter,callback:function(e){t.dsFilter=e},expression:"dsFilter"}})]}}],null,!1,2465650170)}):t._e(),t.datasets.length?e("div",{staticClass:"text-center q-pa-sm"},[e("q-btn",{staticClass:"q-ma-xs",attrs:{color:"primary",icon:"av_timer",disabled:!this.selectedRow||0===this.selectedRow.length},on:{click:function(e){return e.preventDefault(),t.openRange.apply(null,arguments)}}},[t._v("Adjust range\n      ")]),e("q-btn",{staticClass:"q-ma-xs",attrs:{color:"amber",icon:"refresh"},on:{click:function(e){return e.preventDefault(),t.scan.apply(null,arguments)}}},[t._v("reload datasets")])],1):t._e(),t.rangeVisible?e("div",{staticClass:"row"},[e("p",{staticClass:"caption"},[t._v("Here you can adjust the range of the dataset.")])]):t._e(),t.rangeVisible?e("div",{staticClass:"row q-col-gutter-md"},[e("div",{staticClass:"col-6"},[e("q-input",{attrs:{filled:"",dense:"",label:"From",hint:"Pick a start date and time"},scopedSlots:t._u([{key:"prepend",fn:function(){return[e("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[e("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[e("q-date",{attrs:{mask:"YYYY-MM-DD HH:mm"},model:{value:t.customFrom,callback:function(e){t.customFrom=e},expression:"customFrom"}})],1)],1)]},proxy:!0},{key:"append",fn:function(){return[e("q-icon",{staticClass:"cursor-pointer",attrs:{name:"access_time"}},[e("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[e("q-time",{attrs:{mask:"YYYY-MM-DD HH:mm",format24h:""},model:{value:t.customFrom,callback:function(e){t.customFrom=e},expression:"customFrom"}})],1)],1)]},proxy:!0}],null,!1,206458887),model:{value:t.customFrom,callback:function(e){t.customFrom=e},expression:"customFrom"}})],1),e("div",{staticClass:"col-6"},[e("q-input",{attrs:{filled:"",dense:"",label:"To",hint:"Pick an end date and time"},scopedSlots:t._u([{key:"prepend",fn:function(){return[e("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[e("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[e("q-date",{attrs:{mask:"YYYY-MM-DD HH:mm"},model:{value:t.customTo,callback:function(e){t.customTo=e},expression:"customTo"}})],1)],1)]},proxy:!0},{key:"append",fn:function(){return[e("q-icon",{staticClass:"cursor-pointer",attrs:{name:"access_time"}},[e("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[e("q-time",{attrs:{mask:"YYYY-MM-DD HH:mm",format24h:""},model:{value:t.customTo,callback:function(e){t.customTo=e},expression:"customTo"}})],1)],1)]},proxy:!0}],null,!1,4226184359),model:{value:t.customTo,callback:function(e){t.customTo=e},expression:"customTo"}})],1)]):t._e(),t.datasets.length?t._e():e("div",[e("em",[t._v("No Data found\n        "),e("router-link",{attrs:{to:"data/importer"}},[t._v("Lets add some")])],1)])],1):t._e()])}),f=[],h=(a("99af"),a("c1df")),v=a.n(h),b=a("2b0e"),g=a("c41d"),x={data:function(){return{customTo:!1,customFrom:!1,rangeVisible:!1,selectedRows:[],selectedRow:null,minSelectableRange:null,maxSelectableRange:null,dsFilter:""}},mixins:[g["a"]],computed:{isScanning:function(){return"scanning"===this.datasetScanstate},selectedText:function(){return this.selectedRow?"(current: ".concat(this.selectedRow.currency," - ").concat(this.selectedRow.asset,")"):""}},mounted:function(){this.scan()},methods:{fmt:function(t){return v()(t).utc().format("YYYY-MM-DD HH:mm")},openRange:function(){this.updateCustomRange(),this.rangeVisible=!0},updateCustomRange:function(){this.customTo=this.fmt(this.selectedRow.to),this.customFrom=this.fmt(this.selectedRow.from)},emitSet:function(t){var e;t&&(this.customTo?(e=b["a"].util.extend({},t),e.to=v.a.utc(this.customTo,"YYYY-MM-DD HH:mm").format(),e.from=v.a.utc(this.customFrom,"YYYY-MM-DD HH:mm").format()):e=t,this.$emit("dataset",e))}},watch:{selectedRows:function(t){t&&t.length&&(this.selectedRow=b["a"].util.extend({},this.selectedRows[0]),this.selectedRow.from=this.selectedRow.from.toDate(),this.selectedRow.to=this.selectedRow.to.toDate(),this.minSelectableRange=this.selectedRow.from,this.maxSelectableRange=this.selectedRow.to,this.updateCustomRange(),this.emitSet(this.selectedRow[0]))},customTo:function(){this.emitSet(this.selectedRow)},customFrom:function(){this.emitSet(this.selectedRow)}}},k=x,C=a("2877"),w=a("9c40"),y=a("a154"),q=a("eaac"),R=a("27f9"),S=a("0016"),T=a("7cbe"),Y=a("52ee"),D=a("ca78"),F=a("eebe"),B=a.n(F),P=Object(C["a"])(k,m,f,!1,null,null,null),Q=P.exports;B()(P,"components",{QBtn:w["a"],QSpinnerBars:y["a"],QTable:q["a"],QInput:R["a"],QIcon:S["a"],QPopupProxy:T["a"],QDate:Y["a"],QTime:D["a"]});var j=a("e969"),M=a("ae5a"),A=a("2ef0"),H=a.n(A),$={created:function(){var t=this;return p()(d()().mark((function e(){var a;return d()().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.get(t.$store.state.config.apiBaseUrl+"configPart/performanceAnalyzer");case 3:a=e.sent,t.performanceAnalyzer=toml.parse(a.data.part),t.performanceAnalyzer.enabled=!0,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),t.$q.notify({type:"negative",message:"Error getting Perfomance-Analyser config from server."});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},data:function(){return{dataset:{},strat:{},paperTrader:{},performanceAnalyzer:{}}},components:{stratPicker:j["a"],datasetPicker:Q,paperTrader:M["a"]},computed:{market:function(){return this.dataset.exchange?{exchange:this.dataset.exchange,currency:this.dataset.currency.toUpperCase(),asset:this.dataset.asset.toUpperCase()}:{}},range:function(){return this.dataset.exchange?{from:this.dataset.from,to:this.dataset.to}:{}},config:function(){var t={};return Object.assign(t,{watch:this.market},{paperTrader:this.paperTrader},this.strat,{backtest:{daterange:this.range},backtestResultExporter:{enabled:!0,writeToDisk:!1,data:{stratUpdates:!0,roundtrips:!0,stratCandles:!0,stratCandleProps:["open","close","high","low","vwp","volume"],trades:!0}}},{performanceAnalyzer:this.performanceAnalyzer}),t.valid=this.validConfig(t),t.backtestResultExporter.enabled=!0,t}},methods:{validConfig:function(t){if(!t.backtest)return!1;if(!t.backtest.daterange)return!1;if(H.a.isEmpty(t.backtest.daterange))return!1;if(!t.watch)return!1;if(!t.tradingAdvisor)return!1;var e=t.tradingAdvisor.method;if(H.a.isEmpty(t[e]))return!1;if(t.tradingAdvisor){if(H.a.isNaN(t.tradingAdvisor.candleSize))return!1;if(0===t.tradingAdvisor.candleSize)return!1}return!0},updateDataset:function(t){this.dataset=t,this.$emit("config",this.config)},updateStrat:function(t){this.strat=t,this.$emit("config",this.config)},updatePaperTrader:function(t){this.paperTrader=t,this.paperTrader.enabled=!0,this.$emit("config",this.config)}}},E=$,z=Object(C["a"])(E,c,o,!1,null,null,null),O=z.exports,W=function(){var t=this,e=t._self._c;return e("div",{staticClass:"q-my-md"},[e("div",{staticClass:"text-h5 q-mb-md"},[t._v("Backtest result")]),e("div",[t.result&&t.result.performanceReport?e("result-summary",{attrs:{report:t.result.performanceReport}}):t._e()],1),t.candles.length?e("div",[e("q-card",{staticClass:"q-my-md",attrs:{flat:"",bordered:""}},[e("q-card-section",{staticClass:"bg-cyan-1"},[e("div",{staticClass:"text-h6"},[t._v("Market graph")])]),e("q-separator"),e("q-card-section",[e("echart",{attrs:{candles:t.candles,trades:t.trades,indicators:t.indicators}})],1),e("q-separator"),e("q-card-actions",{attrs:{align:"around"}},[e("excel-json",{attrs:{data:t.genExportable(),name:"Backtest-Result.csv",type:"csv"}},[e("q-btn",{attrs:{flat:"",icon:"file_download",label:"backtest CSV",color:"amber"}})],1),e("excel-json",{attrs:{data:t.genExportable(),name:"Backtest-Result.xls",type:"xls"}},[e("q-btn",{attrs:{flat:"",icon:"file_download",label:"backtest XLS",color:"amber"}})],1),t.result.roundtrips&&t.result.roundtrips.length?e("excel-json",{attrs:{data:t.result.roundtrips,name:"Backtest-Roundtrips.xls",type:"xls"}},[e("q-btn",{attrs:{flat:"",icon:"file_download",label:"roundtrips XLS",color:"teal"}})],1):t._e(),t.result.roundtrips&&t.result.roundtrips.length?e("excel-json",{attrs:{data:t.result.roundtrips,name:"Backtest-Roundtrips.csv",type:"csv"}},[e("q-btn",{attrs:{flat:"",icon:"file_download",label:"roundtrips csv",color:"teal"}})],1):t._e()],1)],1)],1):t._e(),e("div",[t.result&&t.result.performanceReport?e("roundtrip-table",{attrs:{roundtrips:t.result.roundtrips,asset:t.result.performanceReport.asset,currency:t.result.performanceReport.currency}}):t._e()],1)])},U=[],L=(a("c975"),a("7db0"),a("d3b7"),a("b680"),function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"row q-col-gutter-md"},[e("div",{staticClass:"col-6"},[e("q-card",{staticClass:"q-pa-sm bg-cyan-1",attrs:{dense:"",flat:"",bordered:""}},[e("div",{staticClass:"row"},[e("div",{staticClass:"col"},[t._v("Start time")]),e("div",{staticClass:"col text-italic"},[t._v(t._s(t.report.startTime))])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col"},[t._v("End time")]),e("div",{staticClass:"col text-italic"},[t._v(t._s(t.report.endTime))])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col"},[t._v("Timespan")]),e("div",{staticClass:"col text-italic"},[t._v(t._s(t.report.timespan))])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col"},[t._v("Start price")]),e("div",{staticClass:"col text-italic"},[t._v(t._s(t.report.startPrice))])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col"},[t._v("End price")]),e("div",{staticClass:"col text-italic"},[t._v(t._s(t.report.endPrice))])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col"},[t._v("Market")]),e("div",{staticClass:"col text-weight-medium text-italic",class:{"text-negative":t.report.market<0,"text-positive":t.report.market>0}},[t._v("\n            "+t._s(t.report.market.toFixed(6))+" %\n          ")])])])],1),e("div",{staticClass:"col-6"},[e("paper-trade-summary",{attrs:{report:t.report}})],1)])])}),V=[],N=function(){var t=this,e=t._self._c;return e("q-card",{staticClass:"q-pa-sm bg-cyan-1",attrs:{dense:"",flat:"",bordered:""}},[e("div",{staticClass:"row"},[e("div",{staticClass:"col"},[t._v("Amount of trades")]),e("div",{staticClass:"col text-italic"},[t._v(t._s(t.report.trades))])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col"},[t._v("Sharpe ratio")]),e("div",{staticClass:"col text-italic"},[t._v(t._s(t.round2(t.report.sharpe)))])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col"},[t._v("Start Balance")]),e("div",{staticClass:"col text-italic"},[t._v(t._s(t.round(t.report.startBalance)))])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col"},[t._v("End Balance")]),e("div",{staticClass:"col text-italic"},[t._v(t._s(t.round(t.report.balance))+" "+t._s(t.report.currency))])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col"},[t._v("Simulated profit")]),e("div",{staticClass:"col text-italic text-h6",class:t.profitClass},[t._v(t._s(t.round(t.report.relativeProfit))+" %")])])])},J=[],I={props:["report"],methods:{round2:function(t){return(+t).toFixed(2)},round:function(t){return(+t).toFixed(5)}},computed:{profitClass:function(){return this.report.relativeProfit>0?"text-positive":"text-negative"}}},X=I,G=a("f09f"),K=Object(C["a"])(X,N,J,!1,null,null,null),Z=K.exports;B()(K,"components",{QCard:G["a"]});var tt={props:["report"],components:{paperTradeSummary:Z},methods:{round:function(t){return(+t).toFixed(5)}}},et=tt,at=Object(C["a"])(et,L,V,!1,null,null,null),st=at.exports;B()(at,"components",{QCard:G["a"]});var rt=a("bdfd"),nt=a("1a90"),it=a("f2d9"),ct={props:["result"],data:function(){return{}},computed:{candles:function(){return this.result.stratCandles||[]},trades:function(){return this.result.trades||[]},indicators:function(){return this.result.stratUpdates||[]}},methods:{genExportable:function(){if(this.candles&&this.candles.length&&this.trades&&this.trades.length){var t=H.a.cloneDeep(this.candles);return H.a.each(this.trades,(function(e){var a=H.a.indexOf(t,H.a.find(t,(function(t){return t.start===e.date})));a>=0&&H.a.set(t[a],"advice",e.action)})),H.a.each(t,(function(t){t.advice||H.a.set(t,"advice","")})),t}return[]}},components:{roundtripTable:rt["a"],resultSummary:st,echart:nt["a"],ExcelJson:it["a"]}},ot=ct,lt=a("a370"),dt=a("eb85"),ut=a("4b7e"),pt=Object(C["a"])(ot,W,U,!1,null,null,null),mt=pt.exports;B()(pt,"components",{QCard:G["a"],QCardSection:lt["a"],QSeparator:dt["a"],QCardActions:ut["a"],QBtn:w["a"]});var ft=a("469d"),ht={mixins:[ft["a"]],data:function(){return{backtestable:!1,backtestState:"idle",config:!1,candleWriter:!0}},created:function(){var t=this;this.$axios.get(this.$store.state.config.apiBaseUrl+"configPart/candleWriter").then((function(e){t.candleWriter=toml.parse(e.data.part)}))["catch"]((function(t){console.log("error getting candlewriter-config",t)}))},computed:{backtestResult:function(){return this.$store.getters["backtest/result"]}},methods:{check:function(t){if(this.config=t,!t.valid)return this.backtestable=!1;this.backtestable=!0},run:function(){var t=this;this.backtestState="fetching";this.$axios.post(this.$store.state.config.apiBaseUrl+"backtest",this.config).then((function(e){t.backtestState="fetched",t.$store.dispatch("backtest/setBacktestResult",e.data)}))["catch"]((function(e){console.error(e),t.$q.notify({type:"negative",message:"Error during backtest-fetching of data."}),t.backtestState="error"}))},startLiveGekko:function(t){var e=this;this.candleWriter&&(this.config["candleWriter"]=this.candleWriter,this.config["watch"]["candleWriter"]=this.candleWriter),this.config.type=t?"paper trader":"tradebot",t||_.set(this.config,"paperTrader.enabled",!1),this.$q.dialog({title:"Start live "+this.config.type+"?",message:"Do you really want to start a live "+this.config.type+" for "+this.config.watch.currency+"-"+this.config.watch.asset+" on "+this.config.watch.exchange+" with the current backtest settings?",ok:"Yes",cancel:"No"}).then((function(){t||_.set(e.config,"trader.enabled",!0),e.start()}))}},components:{configBuilder:O,result:mt}},vt=ht,bt=Object(C["a"])(vt,n,i,!1,null,null,null),gt=bt.exports;B()(bt,"components",{QBtn:w["a"],QSpinnerBars:y["a"]});var _t={name:"BacktesterPage",components:{Backtester:gt}},xt=_t,kt=a("9989"),Ct=Object(C["a"])(xt,s,r,!1,null,null,null);e["default"]=Ct.exports;B()(Ct,"components",{QPage:kt["a"]})}}]);