(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[7],{"8e5a":function(t,a,e){"use strict";e.r(a);e("14d9");var n=function(){var t=this,a=t._self._c;return a("q-page",{attrs:{padding:""}},[a("div",{staticClass:"text-h4 q-mb-md"},[t._v("Import data")]),a("div",{staticClass:"subheading"},[t._v("The importer can download historical market data directly from the exchange.")]),a("div",{staticClass:"row justify-center q-pa-md"},[a("q-btn",{attrs:{color:"blue-grey-7",label:"Start Import"},on:{click:function(a){return a.preventDefault(),t.run.apply(null,arguments)}}})],1),a("div",[a("q-tabs",{staticClass:"text-grey",attrs:{"active-color":"blue-grey","indicator-color":"blue-grey"},model:{value:t.currentTab,callback:function(a){t.currentTab=a},expression:"currentTab"}},[a("q-tab",{attrs:{icon:"av_timer",name:"running-imports",label:"Running imports"}}),a("q-tab",{attrs:{icon:"add",name:"start-new",label:"Start new import"}})],1),a("q-separator"),a("q-tab-panels",{attrs:{animated:""},model:{value:t.currentTab,callback:function(a){t.currentTab=a},expression:"currentTab"}},[a("q-tab-panel",{attrs:{name:"running-imports"}},[a("div",{staticClass:"row justify-center"},[0===t.imports.length?a("q-banner",{staticClass:"bg-warning",attrs:{icon:"warning"}},[t._v("\n            You currently don't have any imports running.\n          ")]):t._e(),t._l(t.imports,(function(e){return a("q-card",{key:e.id,staticClass:"col-lg-1 col-md-12 text-center q-mr-md q-mt-sm"},[a("q-card-section",{staticClass:"bg-teal-2"},[a("div",{staticClass:"text-h6 text-uppercase"},[t._v("\n                "+t._s(e.watch.currency)+"-"+t._s(e.watch.asset)+"\n              ")]),a("div",{staticClass:"text-subtitle-2"},[t._v("\n                "+t._s(e.watch.exchange)+"\n              ")])]),a("q-separator"),a("q-card-section",[a("q-circular-progress",{staticClass:"q-ma-md",class:{"text-teal":!e.done,"text-positive":e.done},attrs:{min:0,max:100,thickness:.2,size:"102px","show-value":"",value:+t.progress(e)}},[e.done?a("q-icon",{attrs:{size:"64px",color:"positive",name:"done"}}):t._e(),e.done?t._e():a("span",{staticClass:"text-h6"},[t._v(t._s(+t.progress(e))+" %")])],1)],1),a("q-separator"),a("q-card-actions",{attrs:{align:"center"}},[a("q-btn",{attrs:{color:"teal",flat:""},on:{click:function(a){return t.$router.push("/data/importer/import/"+e.id)}}},[t._v("\n                open import\n              ")])],1)],1)}))],2)]),a("q-tab-panel",{attrs:{name:"start-new"}},[a("import-config-builder",{on:{config:t.updateConfig}})],1)],1)],1)])},r=[],s=(e("b680"),function(){var t=this,a=t._self._c;return a("div",{staticClass:"row justify-around items-top"},[a("market-picker",{staticClass:"col-3",attrs:{"only-importable":!0},on:{market:t.updateMarketConfig}}),a("range-creator",{staticClass:"col-3",on:{range:t.updateRange}})],1)}),i=[],o=(e("cca6"),e("e81c")),c=function(){var t=this,a=t._self._c;return a("q-card",{staticClass:"q-ma-sm"},[a("q-card-section",{staticClass:"bg-blue-grey-8 text-white"},[a("div",{staticClass:"text-h6"},[t._v("Daterange")])]),a("q-separator"),a("q-card-section",[a("q-input",{attrs:{filled:"",dense:"",label:"From",hint:"Pick a start date and time"},scopedSlots:t._u([{key:"prepend",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{attrs:{mask:"YYYY-MM-DD HH:mm"},model:{value:t.from,callback:function(a){t.from=a},expression:"from"}})],1)],1)]},proxy:!0},{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"access_time"}},[a("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-time",{attrs:{mask:"YYYY-MM-DD HH:mm",format24h:""},model:{value:t.from,callback:function(a){t.from=a},expression:"from"}})],1)],1)]},proxy:!0}]),model:{value:t.from,callback:function(a){t.from=a},expression:"from"}})],1),a("q-separator"),a("q-card-section",[a("q-input",{attrs:{filled:"",dense:"",label:"To",hint:"Pick an end date and time"},scopedSlots:t._u([{key:"prepend",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{attrs:{mask:"YYYY-MM-DD HH:mm"},model:{value:t.to,callback:function(a){t.to=a},expression:"to"}})],1)],1)]},proxy:!0},{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"access_time"}},[a("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-time",{attrs:{mask:"YYYY-MM-DD HH:mm",format24h:""},model:{value:t.to,callback:function(a){t.to=a},expression:"to"}})],1)],1)]},proxy:!0}]),model:{value:t.to,callback:function(a){t.to=a},expression:"to"}})],1)],1)},l=[],u=e("c1df"),m=e.n(u),d={data:function(){return{from:"",to:""}},created:function(){var t=m()().startOf("minute"),a=t.clone().subtract(3,"months");this.to=this.fmt(t),this.from=this.fmt(a),this.emitRange()},methods:{fmtTs:function(t){return m.a.unix(t).utc()},fmt:function(t){return t.utc().format("YYYY-MM-DD HH:mm")},emitRange:function(){this.$emit("range",{from:this.fmtTs(this.from),to:this.fmtTs(this.to)})},emitManualEntry:function(){if(this.from.length<"4"||this.from.length<"4")return this.$emit("range",{});var t=m.a.utc(this.from),a=m.a.utc(this.to);t.isValid()&&a.isValid()?this.$emit("range",{from:this.fmt(t),to:this.fmt(a)}):this.$emit("range",{})}},watch:{from:function(){this.emitManualEntry()},to:function(){this.emitManualEntry()},config:function(){this.scanned=!1},tab:function(){this.scanned=!1,this.$emit("range",{})},selectedRangeIndex:function(){var t=this.ranges[this.selectedRangeIndex];t&&this.emitRange(t)}}},p=d,f=e("2877"),h=e("f09f"),g=e("a370"),b=e("eb85"),x=e("27f9"),v=e("0016"),q=e("7cbe"),y=e("52ee"),C=e("ca78"),k=e("eebe"),w=e.n(k),_=Object(f["a"])(p,c,l,!1,null,null,null),Y=_.exports;w()(_,"components",{QCard:h["a"],QCardSection:g["a"],QSeparator:b["a"],QInput:x["a"],QIcon:v["a"],QPopupProxy:q["a"],QDate:y["a"],QTime:C["a"]});var Q={data:function(){return{market:{},range:{}}},components:{marketPicker:o["a"],rangeCreator:Y},computed:{config:function(){var t={};return Object.assign(t,this.market,{importer:{daterange:this.range}},{candleWriter:{enabled:!0}}),t}},methods:{updateMarketConfig:function(t){this.market=t,this.emitConfig()},updateRange:function(t){this.range=t,this.emitConfig()},emitConfig:function(){this.$emit("config",this.config)}}},M=Q,T=Object(f["a"])(M,s,i,!1,null,null,null),$=T.exports,D=e("af47"),H={methods:{startImport:function(t){return this.$axios.post(D["a"]+"import",t)}}},I=H,P={mixins:[I],components:{importConfigBuilder:$},data:function(){return{config:{},currentTab:"running-imports"}},mounted:function(){this.imports.length||(this.currentTab="start-new")},computed:{imports:function(){return this.$store.state.imports.imports}},methods:{progress:function(t){if(t){if(t.done)return 100;var a=m.a.utc(t.to).diff(m.a.utc(t.from))-m.a.utc(t.to).diff(m.a.utc(t.latest)),e=100*a;return e/=m.a.utc(t.to).diff(m.a.utc(t.from)),!!e&&+e.toFixed(2)}},daysApart:function(t){var a=m()(t.to),e=m()(t.from);return a.diff(e,"days")},updateConfig:function(t){this.config=t},run:function(){var t=this,a=this.daysApart(this.config.importer.daterange);if(a<1)this.$q.dialog({title:"Error",message:"You can only import at least one day of data."});else{var e=this.$store.state.config.exchanges[this.config.watch.exchange];"exchangeMaxHistoryAge"in e&&m()(this.config.importer.daterange.from)<m()().subtract(e.exchangeMaxHistoryAge,"days")?this.$q.dialog({title:"Error",message:"Your date from is too old for "+this.config.watch.exchange+". It supports only the last "+e.exchangeMaxHistoryAge+" days.."}):this.startImport(this.config).then((function(a){t.$store.dispatch("imports/addImport",a.data),t.$router.push({path:"/data/importer/import/".concat(a.data.id)})}))["catch"]((function(a){console.error(a),t.$q.notify({message:"An error occured while trying to start the import!",color:"negative"})}))}}}},R=P,S=e("9989"),j=e("9c40"),A=e("429b"),E=e("7460"),O=e("adad"),B=e("823b"),z=e("54e1"),F=e("58ea"),J=e("4b7e"),V=Object(f["a"])(R,n,r,!1,null,null,null);a["default"]=V.exports;w()(V,"components",{QPage:S["a"],QBtn:j["a"],QTabs:A["a"],QTab:E["a"],QSeparator:b["a"],QTabPanels:O["a"],QTabPanel:B["a"],QBanner:z["a"],QCard:h["a"],QCardSection:g["a"],QCircularProgress:F["a"],QIcon:v["a"],QCardActions:J["a"]})}}]);